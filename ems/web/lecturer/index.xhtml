<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head></h:head>

    <h:body>

        <ui:composition template="../template/mainLayout.xhtml">
            <ui:define name="content">

                <!--                <f:metadata>
                                    <f:event type="preRenderView" listener="#{questionController.retrieveModules()}"/>
                                </f:metadata>-->

                <h2>Question Management</h2>
                <h:form id="form">
                     <p:messages/>
                    <p:commandButton value="Create Question" type="button" onclick="PF('createQuestionDialog').show();" /> 
                    
                    <p:dataTable id="" value="" var="" >
                        
                    </p:dataTable>
                    
                    <p:dialog header="Create Question" widgetVar="createQuestionDialog" minHeight="40" height="500" width="500">
                        
                        <p:messages/>
                    <h:panelGrid columns="2" cellpadding="5">
                        <p:outputLabel for="moduleDropDown" value="Select Module :" />
                        <p:selectOneMenu id="moduleDropDown" value="#{questionController.moduleSelected.moduleName}" style="width:150px" required="true" >
<!--                            <p:ajax listener="#{questionController.onCountryChange}" update="city" />-->
                            <!--                            <f:selectItem itemLabel="Select Module" itemValue="" noSelectionOption="false" />-->
                            <f:selectItems value="#{questionController.retrieveModules()}" />
                        </p:selectOneMenu>
                        <p:outputLabel for="subjectTagDropDown" value="Select Subject :" />
                        <p:selectManyMenu id="subjectTagDropDown" value="#{questionController.subjectTagsSelected}" filter="true" filterMatchMode="contains" showCheckbox="true" required="true">
                            <f:selectItems value="#{questionController.retrieveSubjectTags()}" />
                        </p:selectManyMenu>

                        <p:outputLabel for="questionTypeDropDown" value="Select Question Type :" />
                        <p:selectOneMenu id="questionTypeDropDown" value="#{questionController.questionType}" required="true">
                            <p:ajax  update="questionPG" />
                            <f:selectItems value="#{questionController.questionTypes}" />
                        </p:selectOneMenu>


                    </h:panelGrid>

                    <h:panelGroup id="questionPG" >

                        <p:panelGrid columns="1" rendered="#{questionController.questionType.label=='MCQ One Correct'}">

                            <h:panelGroup>
                                <p:outputLabel for="questionText" value="Question :" />

                                <p:editor id="questionText"  value="#{questionController.questionText}" width="600" required="true" requiredMessage="Question Text is required"/>
                                <p:message for="questionText" />
                            </h:panelGroup>

                            <h:panelGroup>
                                <p:outputLabel for="markInputText" value="Mark"/>
                                <p:inputText id="markInputText" value="#{questionController.mark}" required="true" requiredMessage="Mark is required"/>
                                <p:message for="markInputText" />
                            </h:panelGroup>

                            <h:panelGroup>
                                <p:commandButton  value="Add" actionListener="#{questionController.addOption(questionController.option)}" process="@this,optionInputText" update="questionOptionDataTable,optionInputText"   />

                                <p:inputText id="optionInputText" value="#{questionController.option}" required="true"/>
                            </h:panelGroup>
                            <p:dataTable id="questionOptionDataTable" value="#{questionController.options}" var="option">
                                <p:column headerText="Options">
                                    <h:outputText value="#{option}" />
                                    <p:commandButton value="Remove" action="#{questionController.removeOption(option)}" process="@this" update="questionOptionDataTable"/>
                                </p:column>
                            </p:dataTable>


                        </p:panelGrid>

                        <p:outputLabel value="MCQ Multiple Correct" rendered="#{questionController.questionType.label=='MCQ Multiple Correct'}"/>
                        <p:outputLabel value="Essay" rendered="#{questionController.questionType.label=='Essay'}"/>
                        <p:outputLabel value="Multi Part" rendered="#{questionController.questionType.label=='Multi Part'}"/>

                        <p:commandButton value="Create Question" action="#{questionController.createQuestion}" process="@this,moduleDropDown,subjectTagDropDown,questionTypeDropDown,questionText,markInputText" update="form"/>
                    </h:panelGroup>

                    </p:dialog>
                    





                </h:form>   			
            </ui:define>

        </ui:composition>

    </h:body>

</html>



